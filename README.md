# Inception-of-Things

Целью проекта является знакомство с kubernetes и его базовыми объектами.

По условию, весь проект должен быть представлен в виртуальной машине - для этого в корневой директории присутствует файл - Vagrantfile. С помощью команды `vagrant up`, вспомогательно приложение vagrant, поднимаает виртуальную машину ubuntu - с настроенным окружением - предустановлены kubectl, docker, vagrant, virtualbox, а также настроены параметры самой вирутальной машины - 3 ядра процессора и 6гб оперативной памяти. Далее все шаги выполняются в этой виртуальной машине, для чего необходимо подключиться к ней с помощью команды `vagrant ssh`.

p1 - В данном этапе необходимо установить сервер и агент k3s, на две отдельные виртуальные машины, и осуществить их связь через приватную виртуальную сеть. Виртуальные машины поднимаются выполнением команды `vagrant up` в директории p1. После раскатки подключиться к виртульной машине серверу - `vagrant ssh eklompusS`, и проверить корректность настройки - `k get nodes -o wide`. Должны быть выведены два узла - eklompuss и eklompussw, c ip 192.168.42.110 и 192.168.42.111.

p2 - Необходимо развернуть на одном узле три приложения, одно из них с тремя репликами. Этап должен быть выполнен в виртуальной машине - поднимается командой `vagrant up` в директории p2. Также должен быть настроен роут с внешнего ip на сервисы в зависимости от хэдера Host в http запросе. Если `Host: app1.com` то роут должен идти на первое приложение, если `Ноst: app2.com` то на второе, в любом другом случае на третий. Проверяется запросами `curl 192.168.42.110 -H "Host: app1.com"`, `curl 192.168.42.110 -H "Host: app2.com"`, `curl 192.168.42.110 -H "Host: app3.com"` в командной строке, либо переходом по адресам app1.com, app2.com, app3.com в браузере. На экран выводится имя приложения и под ответивший на запрос.

p3 - Создание кластера kubernetes осуществляется с поомщью k3d - по сути k3s в докере, для выполнения переходим в каталог p3/scripts и выполняем скрипт `./install.sh` - выполняется установка argocd - приложения отвечающего за Continious Delivery. После установки ожидаем поднятия сервера на localhost:8080, узнаем предустановленный пароль пользователя admin с помощью скрипта `./argo_pass.sh`. Далее логинимся в панель управлениия - оздаем новое приложение, где указываем адрес репозитория и путь из файла `p3/confs/github.txt`. Результатом должно быть работающее приложение на кластере k3d и отвечающее по адресу localhost:8888. Чтобы проверить корректность работы CD необходимо также изменить образ или его версию в конфигурации расположенной во внешнем репозитории - вывод по localhost:8888 должен измениться.
